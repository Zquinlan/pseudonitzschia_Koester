filter(Experiment == "Exp2")%>%
unite(sample, c(Organism), sep = "_")%>%
spread(sample, chl_norm)%>%
summarize_if(is.numeric, mean, na.rm = TRUE)
cyto_exp1_org2 <- cyto_base%>%
group_by(Organism, feature_number)%>%
select(-c('chl', 'xic', 'asin', 'ra'))%>%
filter(Experiment == "Exp1")%>%
unite(sample, c(Experiment, Organism), sep = "_")%>%
spread(sample, chl_norm)%>%
summarize_if(is.numeric, mean, na.rm = TRUE)
cyto_piers <- cyto_base%>%
group_by(Organism, biological_replicates, feature_number)%>%
select(-c('chl', 'xic', 'asin', 'chl_norm'))%>%
filter(Experiment == "Piers")%>%
unite(sample, c(Organism, biological_replicates), sep = "_")%>%
spread(sample, ra)%>%
summarize_if(is.numeric, mean, na.rm = TRUE)
cyto_CCE <- cyto_base%>%
group_by(Organism, biological_replicates, feature_number)%>%
select(-c('chl', 'xic', 'asin', 'chl_norm'))%>%
filter(Experiment == "CCE-P1706")%>%
unite(sample, c(Organism, biological_replicates), sep = "_")%>%
spread(sample, ra)%>%
summarize_if(is.numeric, mean, na.rm = TRUE)
cyto_piers_mean <- cyto_base%>%
group_by(feature_number)%>%
select(-c('chl', 'xic', 'asin', 'chl_norm'))%>%
filter(Experiment == "Piers")%>%
summarize_if(is.numeric, mean, na.rm = TRUE)%>%
rename(mean_piers = 2)
cyto_CCE_mean <- cyto_base%>%
group_by(feature_number)%>%
select(-c('chl', 'xic', 'asin', 'chl_norm'))%>%
filter(Experiment == "CCE-P1706")%>%
summarize_if(is.numeric, mean, na.rm = TRUE)%>%
rename(mean_CCE = 2)
cyto_xic_sum <- cyto_base%>%
group_by(feature_number)%>%
select(-c('chl', 'ra', 'asin', 'chl_norm'))%>%
filter(Experiment == "Exp2")%>%
summarize_if(is.numeric, sum, na.rm = TRUE)%>%
rename(sum_xic_exp2 = 2)
cyto_xic_sum_env <- cyto_base%>%
group_by(feature_number)%>%
select(-c('chl', 'ra', 'asin', 'chl_norm'))%>%
filter(Experiment != "Exp1")%>%
summarize_if(is.numeric, sum, na.rm = TRUE)%>%
rename(sum_xic_exp2env = 2)
cyto_full <- cyto_exp2_org%>%
full_join(cyto_exp2_org2, by = "feature_number")%>%
full_join(cyto_exp2_dom, by = "feature_number")%>%
full_join(cyto_exp1_org2, by = "feature_number")%>%
full_join(cyto_piers, by = "feature_number")%>%
full_join(cyto_piers_mean, by = "feature_number")%>%
full_join(cyto_CCE, by = "feature_number")%>%
full_join(cyto_CCE_mean, by = "feature_number")%>%
full_join(cyto_xic_sum, by = "feature_number")%>%
full_join(cyto_xic_sum_env, by = "feature_number")
write_csv(cyto_full, "./Analyzed/cyto_node_table.csv")
# VISUALIZATION -- PCoA org and unfilfil -------------------------------------------------
##Quant all
pcoa_quant <- quant_stats%>%
unite(sample, c("Experiment", "Organism", "biological_replicates", "DOM_fil", "technical_replicates"), sep = "_")%>%
spread(feature_number, asin)%>%
column_to_rownames("sample")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_quant$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
## otu exp2
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment == 'Exp2')%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_otu$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
##OTU Exp1 and 2 del,mul,sub
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")
View(pcoa_otu)
##OTU Exp1 and 2 del,mul,sub
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'CCE-P1706',
Experiment != 'Piers')%>%
filter(Organism != 'Pn-hasleana',
Organism != 'Pn-galaxiae')
warnings()
##OTU Exp1 and 2 del,mul,sub
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'CCE-P1706',
Experiment != 'Piers')%>%
filter(Organism != 'Pn-hasleana',
Organism != 'Pn-galaxiae')%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'Piers',
Experiment != 'CCE-P1706')%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_otu$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'Piers',
Experiment != 'CCE-P1706')
View(pcoa_otu)
pcoa_otu
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'Piers',
Experiment != 'CCE-P1706')%>%
group_by(Taxonomy)%>%
filter(sum(asin) != 0)%>%
ungroup()
View(otu_taxonomy)
View(pcoa_otu)
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'Piers',
Experiment != 'CCE-P1706')
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'CCE-P1706',
Experiment != 'Piers')%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
warnings()
pcoa_otu$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
##OTU Exp1 and 2 del,mul,sub
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'CCE-P1706',
Experiment != 'Piers')%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_otu$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
## Organism Matrix
pcoa_org <- matrix_multiplied_org%>%
gather(cat, val, 2:ncol(.))%>%
mutate(val = val+ min(val) +1)%>%
spread(cat, val)%>%
column_to_rownames("sample_code")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_org$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
## Unfil vs Fil matrix
pcoa_dom <- matrix_multiplied_dom%>%
gather(cat, val, 2:ncol(.))%>%
mutate(val = val+ min(val) +1)%>%
spread(cat, val)%>%
column_to_rownames("sample_code")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_dom$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
#Settings for Pcoas
pcoa_settings <- function(x) {
ggplot(x, aes(Axis.1, Axis.2, color = Organism, shape = DOM_fil)) +
geom_point(stat = "identity") +
scale_color_manual(values = c("#75d648", "#ae2da9", "#2d67c7", "#f27304", "#64d6f7")) +
scale_shape_manual(values=c(1, 16))+
theme(panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
axis.title.x = element_text(size=14, face="bold"),
axis.title.y = element_text(size=14, face="bold"),
axis.text.x = element_text(face="bold", size=14),
axis.text.y = element_text(face="bold", size=14),
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent"), # get rid of legend panel bg
axis.line = element_line(color="black"))
}
## Plotting PCoAs
pdf("Plots/PCoA_all.pdf", width = 7, height = 5)
pcoa_quant$vectors%>%
as.data.frame()%>%
rownames_to_column("sample_code")%>%
separate(sample_code, c("Experiment", "Organism", "biological_replicates", "DOM_fil",
"technical_replicates"), sep = "_")%>%
pcoa_settings() +
ylab(str_c("Axis 2", " (", round(pcoa_quant$values$Relative_eig[2], digits = 4)*100, "%)", sep = "")) +
xlab(str_c("Axis 1", " (", round(pcoa_quant$values$Relative_eig[1], digits = 4)*100, "%)", sep = "")) +
ggtitle("quant all")
pcoa_otu$vectors%>%
as.data.frame()%>%
rownames_to_column("sample_code")%>%
separate(sample_code, c("Experiment", "Organism", "biological_replicates", "technical_replicates"), sep = "_")%>%
ggplot(aes(Axis.1, Axis.2, color = Organism, shape = Experiment)) +
geom_point(stat = "identity", aes(size = 0.1)) +
scale_color_manual(values = c("#75d648", "#ae2da9", "#2d67c7", "#f27304", "#64d6f7")) +
theme(panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
axis.title.x = element_text(size=14, face="bold"),
axis.title.y = element_text(size=14, face="bold"),
axis.text.x = element_text(face="bold", size=14),
axis.text.y = element_text(face="bold", size=14),
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent"), # get rid of legend panel bg
axis.line = element_line(color="black"))+
ylab(str_c("Axis 2", " (", round(pcoa_otu$values$Relative_eig[2], digits = 4)*100, "%)", sep = "")) +
xlab(str_c("Axis 1", " (", round(pcoa_otu$values$Relative_eig[1], digits = 4)*100, "%)", sep = "")) +
ggtitle("otus")
pcoa_org$vectors%>%
as.data.frame()%>%
rownames_to_column("sample_code")%>%
separate(sample_code, c("Experiment", "Organism", "biological_replicates", "DOM_fil",
"technical_replicates"), sep = "_")%>%
pcoa_settings() +
ylab(str_c("Axis 2", " (", round(pcoa_org$values$Relative_eig[2], digits = 4)*100, "%)", sep = "")) +
xlab(str_c("Axis 1", " (", round(pcoa_org$values$Relative_eig[1], digits = 4)*100, "%)", sep = "")) +
ggtitle("Organism 0.05")
pcoa_dom$vectors%>%
as.data.frame()%>%
rownames_to_column("sample_code")%>%
separate(sample_code, c("Experiment", "Organism", "biological_replicates", "DOM_fil",
"technical_replicates"), sep = "_")%>%
pcoa_settings() +
ylab(str_c("Axis 2", " (", round(pcoa_dom$values$Relative_eig[2], digits = 4)*100, "%)", sep = "")) +
xlab(str_c("Axis 1", " (", round(pcoa_dom$values$Relative_eig[1], digits = 4)*100, "%)", sep = "")) +
ggtitle("UnfilFil 0.05")
dev.off()
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'CCE-P1706',
Experiment != 'Piers')
View(pcoa_otu)
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'CCE-P1706',
Experiment != 'Piers')%>%
group_by(Taxonomy)%>%
filter(sum(asin) != 0)%>%
ungroup()%>%
%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != 'CCE-P1706',
Experiment != 'Piers')%>%
group_by(Taxonomy)%>%
filter(sum(asin) != 0)%>%
ungroup()
View(pcoa_otu)
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != "CCE-P1706",
Experiment != "Piers")%>%
group_by(Taxonomy)%>%
filter(sum(asin) != 0)%>%
ungroup()
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != "CCE-P1706",
Experiment != "Piers")%>%
group_by(Taxonomy)%>%
filter(sum(asin) != 0)%>%
ungroup()%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_otu$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != "CCE-P1706",
Experiment != "Piers")%>%
group_by(Taxonomy)%>%
filter(sum(asin) != 0)%>%
ungroup()%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
## otu
pcoa_otu <- otu_stats%>%
separate(sample_code_16S, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
filter(Experiment != "CCE-P1706",
Experiment != "Piers")%>%
group_by(Taxonomy)%>%
filter(sum(asin) != 0)%>%
ungroup()%>%
unite(sample_name, c("Experiment", "Organism", "biological_replicates",
"technical_replicates"), sep = "_")%>%
select(-c(reads, ra))%>%
spread(Taxonomy, asin)%>%
column_to_rownames("sample_name")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_otu$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
## Organism Matrix
pcoa_org <- matrix_multiplied_org%>%
gather(cat, val, 2:ncol(.))%>%
mutate(val = val+ min(val) +1)%>%
spread(cat, val)%>%
column_to_rownames("sample_code")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_org$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
## Unfil vs Fil matrix
pcoa_dom <- matrix_multiplied_dom%>%
gather(cat, val, 2:ncol(.))%>%
mutate(val = val+ min(val) +1)%>%
spread(cat, val)%>%
column_to_rownames("sample_code")%>%
vegdist(na.rm = TRUE)%>%
pcoa()
pcoa_dom$values[1:10,]%>%
as.data.frame()%>%
rownames_to_column("Axis")%>%
mutate(axis = as.numeric(Axis))%>%
ggplot(aes(reorder(Axis, axis), Relative_eig, label = round(Relative_eig, digits = 3))) +
geom_bar(stat = "identity") +
geom_text(size = 3, color = "red", vjust = -0.5)
#Settings for Pcoas
pcoa_settings <- function(x) {
ggplot(x, aes(Axis.1, Axis.2, color = Organism, shape = DOM_fil)) +
geom_point(stat = "identity") +
scale_color_manual(values = c("#75d648", "#ae2da9", "#2d67c7", "#f27304", "#64d6f7")) +
scale_shape_manual(values=c(1, 16))+
theme(panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
axis.title.x = element_text(size=14, face="bold"),
axis.title.y = element_text(size=14, face="bold"),
axis.text.x = element_text(face="bold", size=14),
axis.text.y = element_text(face="bold", size=14),
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent"), # get rid of legend panel bg
axis.line = element_line(color="black"))
}
## Plotting PCoAs
pdf("Plots/PCoA_all.pdf", width = 7, height = 5)
pcoa_quant$vectors%>%
as.data.frame()%>%
rownames_to_column("sample_code")%>%
separate(sample_code, c("Experiment", "Organism", "biological_replicates", "DOM_fil",
"technical_replicates"), sep = "_")%>%
pcoa_settings() +
ylab(str_c("Axis 2", " (", round(pcoa_quant$values$Relative_eig[2], digits = 4)*100, "%)", sep = "")) +
xlab(str_c("Axis 1", " (", round(pcoa_quant$values$Relative_eig[1], digits = 4)*100, "%)", sep = "")) +
ggtitle("quant all")
pcoa_otu$vectors%>%
as.data.frame()%>%
rownames_to_column("sample_code")%>%
separate(sample_code, c("Experiment", "Organism", "biological_replicates", "technical_replicates"), sep = "_")%>%
ggplot(aes(Axis.1, Axis.2, color = Organism, shape = Experiment)) +
geom_point(stat = "identity", aes(size = 0.1)) +
scale_color_manual(values = c("#75d648", "#ae2da9", "#2d67c7", "#f27304", "#64d6f7")) +
theme(panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
axis.title.x = element_text(size=14, face="bold"),
axis.title.y = element_text(size=14, face="bold"),
axis.text.x = element_text(face="bold", size=14),
axis.text.y = element_text(face="bold", size=14),
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent"), # get rid of legend panel bg
axis.line = element_line(color="black"))+
ylab(str_c("Axis 2", " (", round(pcoa_otu$values$Relative_eig[2], digits = 4)*100, "%)", sep = "")) +
xlab(str_c("Axis 1", " (", round(pcoa_otu$values$Relative_eig[1], digits = 4)*100, "%)", sep = "")) +
ggtitle("otus")
pcoa_org$vectors%>%
as.data.frame()%>%
rownames_to_column("sample_code")%>%
separate(sample_code, c("Experiment", "Organism", "biological_replicates", "DOM_fil",
"technical_replicates"), sep = "_")%>%
pcoa_settings() +
ylab(str_c("Axis 2", " (", round(pcoa_org$values$Relative_eig[2], digits = 4)*100, "%)", sep = "")) +
xlab(str_c("Axis 1", " (", round(pcoa_org$values$Relative_eig[1], digits = 4)*100, "%)", sep = "")) +
ggtitle("Organism 0.05")
pcoa_dom$vectors%>%
as.data.frame()%>%
rownames_to_column("sample_code")%>%
separate(sample_code, c("Experiment", "Organism", "biological_replicates", "DOM_fil",
"technical_replicates"), sep = "_")%>%
pcoa_settings() +
ylab(str_c("Axis 2", " (", round(pcoa_dom$values$Relative_eig[2], digits = 4)*100, "%)", sep = "")) +
xlab(str_c("Axis 1", " (", round(pcoa_dom$values$Relative_eig[1], digits = 4)*100, "%)", sep = "")) +
ggtitle("UnfilFil 0.05")
dev.off()
